import{api}from"../../data/api.js";const conten=document.getElementById("conten_courses"),conten_courses_add=document.getElementById("conten_courses_add"),card_payment_method=document.getElementById("card_payment_method");let all_course_add=[];const count_course=()=>{let e=document.getElementById("conten_count_course");if(all_course_add=JSON.parse(localStorage.getItem("course")),null===all_course_add)return all_course_add=[],all_course_add;e.innerText=all_course_add.length},get_info_course=(e,t,n,c,a)=>{let o={id:e,name:t,src:n,symbol:c,price:a,count:1,final_p:a};return all_course_add.push(o),o},add_course_local_storage=()=>{localStorage.setItem("course",JSON.stringify(all_course_add)),count_course(),show_courses_local_storage()},render_courses=()=>{try{api.forEach((e=>{const t=document.createElement("div");t.className="card";const n=document.createElement("span");n.className="title-card ",n.innerText=e.name;const c=document.createElement("img");c.className="img_icon",c.src=e.src,c.alt=e.alt;const a=document.createElement("div");a.className="conten-dolar-symbol-price";const o=document.createElement("span");o.className="dolar-symbol",o.innerText=e.dolar_symbol;const d=document.createElement("span");d.className="course-price",d.innerText=e.price;const l=document.createElement("button");l.className="btn_add_course",l.id="btn_add_course",l.dataset.test="btn_add_course",l.className="btn-add-course",l.innerText="Add",a.append(o),a.append(d),t.append(n),t.append(c),t.append(a),t.append(l),conten.append(t),l.addEventListener("click",(()=>{all_course_add.some((t=>t.id===e.id))||(get_info_course(e.id,e.name,e.src,e.dolar_symbol,e.price),add_course_local_storage())}))}))}catch(e){console.log(e)}},show_courses_local_storage=()=>{try{if(conten_courses_add.innerHTML="",all_course_add=JSON.parse(localStorage.getItem("course")),null===all_course_add)return all_course_add=[],all_course_add;all_course_add.forEach((e=>{let t=document.createElement("div");t.className="conten_info_course";let n=document.createElement("div");n.className="conten-img";let c=document.createElement("img");c.src=e.src,c.className="img-course",n.append(c);let a=document.createElement("span");a.innerText=e.name,a.className="course-name";let o=document.createElement("div");o.className="conten-price";let d=document.createElement("span");d.innerText=e.symbol;let l=document.createElement("span");l.innerText=e.final_p.toFixed(2),o.append(d),o.append(l);let s=document.createElement("div");s.className="conten-more-less-course-count";let r=document.createElement("button");r.classList="btn-more-less",r.innerText="-";let m=document.createElement("span");m.innerText=e.count;let i=document.createElement("button");i.className="btn-more-less",i.innerText="+",s.append(r),s.append(m),s.append(i);let _=document.createElement("span");_.innerText="Remove",_.className="remove-course",_.dataset.test="btn_remove_course";let u=document.createElement("span");u.innerText="Buy",u.className="buy-course",u.dataset.test="btn_buy-course",t.append(n),t.append(a),t.append(o),t.append(_),t.append(u),conten_courses_add.append(t),r.addEventListener("click",(()=>{let t=all_course_add.findIndex((t=>t.id===e.id));if(all_course_add[t].count>=1&&(all_course_add[t].count--,all_course_add[t].final_p=all_course_add[t].final_p-all_course_add[t].price,add_course_local_storage()),0===all_course_add[t].count){let t=all_course_add.findIndex((t=>t.id===e.id));all_course_add.splice(t,1),add_course_local_storage(),count_course()}pay_all_courses()})),i.addEventListener("click",(()=>{let t=all_course_add.findIndex((t=>t.id===e.id));all_course_add[t].count<=9&&(all_course_add[t].count++,all_course_add[t].final_p=all_course_add[t].final_p+all_course_add[t].price,add_course_local_storage()),pay_all_courses()})),_.addEventListener("click",(t=>{let n=all_course_add.findIndex((t=>t.id===e.id));all_course_add.splice(n,1),add_course_local_storage(),count_course(),remove_course_pay()})),u.addEventListener("click",(e=>{let t=e.composedPath()[1].childNodes[0].childNodes[0].attributes[0].value,n=e.composedPath()[1].childNodes[1].innerText,c=e.composedPath()[1].childNodes[2].childNodes[0].innerText,a=e.composedPath()[1].childNodes[2].childNodes[1].innerText;pay_course(t,n,c,a)}))}));const e=all_course_add.reduce(((e,t)=>e+t.final_p),0);if(all_course_add.length>=1){let t=document.createElement("div");t.className="conten-total-price";let n=document.createElement("span");n.innerText="Price of all courses",n.className="text-price";let c=document.createElement("div");c.className="conten-price";let a=document.createElement("span");a.innerText="$",a.className="final-price";let o=document.createElement("span");o.className="final-price",o.innerText=e.toFixed(2),c.append(a),c.append(o);let d=document.createElement("span");d.innerText="Remove all",d.className="remove-course",d.dataset.test="btn_remove_all_courses";let l=document.createElement("span");l.innerText="Buy all",l.className="buy-course",l.dataset.test="btn_buy_all_courses",t.append(n),t.append(c),t.append(d),t.append(l),conten_courses_add.append(t),d.addEventListener("click",(()=>{all_course_add=[],add_course_local_storage(),remove_course_pay();try{card_payment_method.classList.remove("show")}catch(e){console.log(e)}})),l.addEventListener("click",(()=>{pay_all_courses()}))}}catch(e){console.log(e)}},pay_all_courses=()=>{all_course_add=JSON.parse(localStorage.getItem("course"));const e=document.getElementById("conten_info_img");document.getElementById("conten_info_img").innerHTML="";const t=document.getElementById("name");document.getElementById("name").innerHTML="";const n=document.getElementById("conten_price");document.getElementById("conten_price").innerHTML="";const c=document.getElementById("title_price"),a=document.getElementById("title_purchase_information");document.getElementById("title_purchase_information").innerHTML="";const o=all_course_add.reduce(((e,t)=>e+t.final_p),0);all_course_add.forEach((d=>{if(1===all_course_add.length){a.innerText="Purchase information";const l=document.createElement("div");l.className="info-img info-img_one_course";const s=document.createElement("img");s.src=d.src,s.alt=d.alt,s.className="img_buy_course",t.innerHTML=d.name,c.innerText="Price by this course";const r=document.createElement("span");r.innerText="",n.innerText=d.symbol+o.toFixed(2),l.append(s),l.append(r),e.append(l)}else{a.innerText="Purchase information";const t=document.createElement("div");t.className="info-img ";const l=document.createElement("img");l.src=d.src,l.alt=d.alt,c.innerText="Price by all course",n.innerText=d.symbol+o.toFixed(2),t.append(l),e.append(t)}}))},pay_course=(e,t,n,c)=>{const a=document.getElementById("conten_info_img");document.getElementById("conten_info_img").innerHTML="";const o=document.getElementById("name");document.getElementById("name").innerHTML="";const d=document.getElementById("conten_price");document.getElementById("conten_price").innerHTML="";const l=document.getElementById("title_price");document.getElementById("title_price").innerHTML="";const s=document.getElementById("title_purchase_information");document.getElementById("title_purchase_information").innerHTML="",s.innerText="Purchase information";const r=document.createElement("div");r.className="info-img info-img_one_course",o.innerHTML=t;const m=document.createElement("img");m.src=e,m.alt="img-course",m.className="img_buy_course",l.innerText="Price by this course",d.innerText=n+c,r.append(m),a.append(r)},remove_course_pay=()=>{document.getElementById("conten_info_img");document.getElementById("conten_info_img").innerHTML="";document.getElementById("name");document.getElementById("name").innerHTML="";document.getElementById("conten_price");document.getElementById("conten_price").innerHTML="";document.getElementById("title_price");document.getElementById("title_price").innerHTML="";document.getElementById("title_purchase_information");document.getElementById("title_purchase_information").innerHTML=""};count_course(),document.addEventListener("DOMContentLoaded",show_courses_local_storage);export default render_courses;